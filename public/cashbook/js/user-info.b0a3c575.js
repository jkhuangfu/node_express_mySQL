(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user-info"],{"0b08":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.prefixCls],on:{mouseenter:e.handleShowPopper,mouseleave:e.handleClosePopper}},[n("div",{ref:"reference",class:[e.prefixCls+"-rel"]},[e._t("default")],2),n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.disabled&&(e.visible||e.always),expression:"!disabled && (visible || always)"},{name:"transfer-dom",rawName:"v-transfer-dom"}],ref:"popper",class:[e.prefixCls+"-popper",e.prefixCls+"-"+e.theme],style:e.dropStyles,attrs:{"data-transfer":e.transfer},on:{mouseenter:e.handleShowPopper,mouseleave:e.handleClosePopper}},[n("div",{class:[e.prefixCls+"-content"]},[n("div",{class:[e.prefixCls+"-arrow"]}),n("div",{class:e.innerClasses,style:e.innerStyles},[e._t("content",[e._v(e._s(e.content))])],2)])])])],1)},s=[],a=n("bd86"),i=(n("c5f6"),n("a010")),o=n("1f4f"),l=n("cd51"),c=n("22b0"),p="ivu-tooltip",d={name:"Tooltip",directives:{TransferDom:o["a"]},mixins:[i["a"]],props:{placement:{validator:function(e){return Object(l["i"])(e,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},content:{type:[String,Number],default:""},delay:{type:Number,default:100},disabled:{type:Boolean,default:!1},controlled:{type:Boolean,default:!1},always:{type:Boolean,default:!1},transfer:{type:Boolean,default:function(){return!(!this.$IVIEW||""===this.$IVIEW.transfer)&&this.$IVIEW.transfer}},theme:{validator:function(e){return Object(l["i"])(e,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number]}},data:function(){return{prefixCls:p,tIndex:this.handleGetIndex()}},computed:{innerStyles:function(){var e={};return this.maxWidth&&(e["max-width"]="".concat(this.maxWidth,"px")),e},innerClasses:function(){return["".concat(p,"-inner"),Object(a["a"])({},"".concat(p,"-inner-with-width"),!!this.maxWidth)]},dropStyles:function(){var e={};return this.transfer&&(e["z-index"]=1060+this.tIndex),e}},watch:{content:function(){this.updatePopper()}},methods:{handleShowPopper:function(){var e=this;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){e.visible=!0},this.delay),this.tIndex=this.handleGetIndex()},handleClosePopper:function(){var e=this;this.timeout&&(clearTimeout(this.timeout),this.controlled||(this.timeout=setTimeout(function(){e.visible=!1},100)))},handleGetIndex:function(){return Object(c["a"])(),c["b"]}},mounted:function(){this.always&&this.updatePopper()}},u=d,m=n("2877"),f=Object(m["a"])(u,r,s,!1,null,null,null);t["a"]=f.exports},"1bd0":function(e,t,n){"use strict";var r=n("939a"),s=n.n(r);s.a},"3f51":function(e,t,n){"use strict";var r=n("58f2"),s=n.n(r);s.a},"4af6":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"change-info"},[n("input",{ref:"upFile",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.upFile}}),n("div",{staticClass:"change-info-header"},[n("Tooltip",{staticClass:"img",attrs:{content:"点击更换头像",placement:"top"}},[n("img",{attrs:{src:e.img,height:"120",title:"点击修改头像",width:"120"},on:{click:e.clickInput}})]),n("p",{staticClass:"nickName"},[e._v(e._s(e.nickName))])],1),n("div",{staticClass:"change-info-form"},[n("h2",[e._v("修改密码:")]),n("UForm",{ref:"info_form",attrs:{canSend:e.canSend,sendText:e.sendText},on:{"handle-change":e.handleChangePassWord,"send-mail-code":e.sendMail}})],1)])},s=[],a=(n("96cf"),n("3b8d")),i=n("0b08"),o=i["a"],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{ref:"formInline",attrs:{model:e.formInline,rules:e.ruleInline}},[n("FormItem",{attrs:{prop:"oldPassWord"}},[n("Input",{staticClass:"huangfu",attrs:{placeholder:"请输入旧密码",type:"password"},model:{value:e.formInline.oldPassWord,callback:function(t){e.$set(e.formInline,"oldPassWord",t)},expression:"formInline.oldPassWord"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-lock-outline"},slot:"prepend"})],1)],1),n("FormItem",{attrs:{prop:"newPassWord"}},[n("Input",{attrs:{placeholder:"请输入新密码",type:"password"},model:{value:e.formInline.newPassWord,callback:function(t){e.$set(e.formInline,"newPassWord",t)},expression:"formInline.newPassWord"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-lock-outline"},slot:"prepend"})],1)],1),n("FormItem",{attrs:{prop:"email"}},[n("Input",{attrs:{placeholder:"请输入注册时的邮箱",type:"text"},model:{value:e.formInline.email,callback:function(t){e.$set(e.formInline,"email",t)},expression:"formInline.email"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-mail"},slot:"prepend"}),n("Button",{attrs:{slot:"append"},on:{click:e.sendEmailCode},slot:"append"},[e._v(e._s(e.sendText))])],1)],1),n("FormItem",{attrs:{prop:"emailCode"}},[n("Input",{attrs:{placeholder:"请输入邮箱验证码",type:"text"},model:{value:e.formInline.emailCode,callback:function(t){e.$set(e.formInline,"emailCode",t)},expression:"formInline.emailCode"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-mail-open"},slot:"prepend"})],1)],1),n("FormItem",{staticClass:"handle-btn"},[n("Button",{staticClass:"handle-btn_cancel",on:{click:e.cancelChange}},[e._v("取消修改")]),n("Button",{staticClass:"handle-btn_ensure",attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("formInline")}}},[e._v("确认修改")])],1)],1)},c=[],p=(n("7f7f"),n("2d66")),d=n("d3b2"),u=n("01f8"),m=n("d842"),f=n("f2d8"),h={components:{FormItem:f["a"],Form:m["a"],Button:u["a"],Icon:d["a"],Input:p["a"]},data:function(){return{formInline:{newPassWord:"",oldPassWord:"",email:"",emailCode:""},postData:{},ruleInline:{newPassWord:[{required:!0,message:"请输入新密码",trigger:"blur"},{type:"string",min:6,message:"密码不能少于6位",trigger:"blur"}],oldPassWord:[{required:!0,message:"请输入旧密码",trigger:"blur"},{type:"string",min:6,message:"密码不能少于6位",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],emailCode:[{required:!0,type:"string",message:"请输入邮箱验证码",trigger:"blur"}]}}},props:{sendText:{default:"发送验证码"},canSend:{type:Boolean,default:!0}},watch:{formInline:{handler:function(e){var t=e.newPassWord,n=e.oldPassWord,r=e.email,s=e.emailCode;this.postData.newPassWord=this.$md5(t),this.postData.oldPassWord=this.$md5(n),this.postData.email=r,this.postData.emailCode=s},deep:!0}},methods:{handleSubmit:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$refs[t].validate(function(e){e&&n.$emit("handle-change",n.postData)});case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),sendEmailCode:function(){if(this.canSend){var e=this.formInline.email,t=/^\w+((.\w+)|(-\w+))@[A-Za-z0-9]+((.|-)[A-Za-z0-9]+).[A-Za-z0-9]+$/;e&&t.test(e)?this.$emit("send-mail-code",e):this.$Message.error("请检查邮箱")}},cancelChange:function(){this.$refs.formInline.resetFields(),this.$Message.info("取消修改")}}},g=h,v=(n("3f51"),n("2877")),b=Object(v["a"])(g,l,c,!1,null,"67cae0d1",null),w=b.exports,I=n("f8c8"),y={components:{UForm:w,Tooltip:o},data:function(){return{sendText:"发送验证码",canSend:!0,nickName:"",img:""}},created:function(){var e=JSON.parse(window.localStorage.getItem("user_info"));this.nickName=e.nickName,this.img=e.avatar||"http://manager.drnet.xyz/static/img/img.2aab7b4.jpg"},methods:{sendMail:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n,r,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(I["m"])({email:t});case 2:n=e.sent,n&&200===n.code?(this.canSend=!1,r=60,this.timer=setInterval(function(){if(r--,0===r)return clearInterval(s.timer),s.sendText="再次发送",s.canSend=!0,!1;s.sendText="已发送(".concat(r,"s)")},1e3)):n&&this.$Message.info(n.msg);case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),handleChangePassWord:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(I["d"])(t);case 2:n=e.sent,n&&200===n.code?(this.$Message.success("密码修改成功"),this.$refs["info_form"].$refs["formInline"].resetFields()):this.$Message.error(n?n.msg:"系统出错!");case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),clickInput:function(){this.$refs.upFile.click()},upFile:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n,r,s,a,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=null,r=t.target.files[0],s=new FormData,s.append("file",r),s.append("type",this.nickName),e.next=7,Object(I["n"])(s);case 7:if(a=e.sent,!a||200!==a.code){e.next=14;break}return e.next=11,Object(I["c"])({avatar:a.imageUrlArr[0]});case 11:n=e.sent,e.next=15;break;case 14:case 15:n&&200===n.code?(this.img="".concat(a.imageUrlArr[0],"?v=").concat(+new Date),this.$nextTick(function(){i.$store.dispatch("changeAvatar",i.img),window.localStorage.setItem("user_info",JSON.stringify({nickName:i.nickName,avatar:i.img}))})):this.$Message.info("修改失败,"+a.msg);case 16:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},x=y,$=(n("1bd0"),Object(v["a"])(x,r,s,!1,null,"417c046a",null));t["default"]=$.exports},"58f2":function(e,t,n){},"939a":function(e,t,n){},a010:function(e,t,n){"use strict";var r=n("8bbf"),s=n.n(r);const a=s.a.prototype.$isServer,i=a?function(){}:n("d2e4");t["a"]={props:{placement:{type:String,default:"bottom"},boundariesPadding:{type:Number,default:5},reference:Object,popper:Object,offset:{default:0},value:{type:Boolean,default:!1},transition:String,options:{type:Object,default(){return{modifiers:{computeStyle:{gpuAcceleration:!1},preventOverflow:{boundariesElement:"window"}}}}}},data(){return{visible:this.value}},watch:{value:{immediate:!0,handler(e){this.visible=e,this.$emit("input",e)}},visible(e){e?(this.handleIndexIncrease&&this.handleIndexIncrease(),this.updatePopper(),this.$emit("on-popper-show")):this.$emit("on-popper-hide"),this.$emit("input",e)}},methods:{createPopper(){if(a)return;if(!/^(top|bottom|left|right)(-start|-end)?$/g.test(this.placement))return;const e=this.options,t=this.popper||this.$refs.popper,n=this.reference||this.$refs.reference;t&&n&&(this.popperJS&&this.popperJS.hasOwnProperty("destroy")&&this.popperJS.destroy(),e.placement=this.placement,e.modifiers.offset||(e.modifiers.offset={}),e.modifiers.offset.offset=this.offset,e.onCreate=()=>{this.$nextTick(this.updatePopper),this.$emit("created",this)},this.popperJS=new i(n,t,e))},updatePopper(){a||(this.popperJS?this.popperJS.update():this.createPopper())},doDestroy(){a||this.visible||(this.popperJS.destroy(),this.popperJS=null)}},updated(){this.$nextTick(()=>this.updatePopper())},beforeDestroy(){a||this.popperJS&&this.popperJS.destroy()}}}}]);